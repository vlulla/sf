<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. Reading, Writing and Converting Simple Features • sf</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. Reading, Writing and Converting Simple Features">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/sf1.html">1. Simple Features for R</a>
    </li>
    <li>
      <a href="../articles/sf2.html">2. Reading, Writing and Converting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf3.html">3. Manipulating Simple Feature Geometries</a>
    </li>
    <li>
      <a href="../articles/sf4.html">4. Manipulating Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf5.html">5. Plotting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf6.html">6. Miscellaneous</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-spatial/sf">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>2. Reading, Writing and Converting Simple Features</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-spatial/sf/blob/master/vignettes/sf2.Rmd"><code>vignettes/sf2.Rmd</code></a></small>
      <div class="hidden name"><code>sf2.Rmd</code></div>

    </div>

    
    
<p>This vignetted describes how simple features can be read in R from files or databases, and how they can be converted to other formats (text, <a href="https://cran.r-project.org/package=sp">sp</a>)</p>
<div id="reading-and-writing-through-gdal" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-and-writing-through-gdal" class="anchor"></a>Reading and writing through GDAL</h2>
<p>The Geospatial Data Abstraction Library (<a href="http://www.gdal.org/">GDAL</a>) is the swiss army knife for spatial data: it reads and writes vector and raster data from and to practically every file format, or database, of significance. Package <code>sf</code> reads and writes using GDAL by the functions <code>st_read</code> and <code>st_write</code>.</p>
<p>The data model GDAL uses needs</p>
<ul>
<li>a data source, which may be a file, directory, or database</li>
<li>a layer, which is a single geospatial dataset inside a file or directory or e.g. a table in a database.</li>
<li>the specification of a driver (i.e., which format)</li>
<li>driver-specific reading or writing data sources, or layers</li>
</ul>
<p>This may sound complex, but it is needed to map to over 200 data formats! Package <code>sf</code> tries hard to simplify this where possible (e.g. a file contains a single layer), but this vignette will try to point you to the options.</p>
<div id="using-st_read" class="section level3">
<h3 class="hasAnchor">
<a href="#using-st_read" class="anchor"></a>Using st_read</h3>
<p>As an example, we read the North Carolina counties SIDS dataset, which comes shipped with the <code>sf</code> package by:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sf)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">## Linking to GEOS 3.5.0, GDAL 2.2.2, PROJ 4.8.0</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">fname &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"shape/nc.shp"</span>, <span class="dt">package=</span><span class="st">"sf"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">fname</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">## [1] "/home/travis/R/Library/sf/shape/nc.shp"</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">nc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/st_read.html">st_read</a></span>(fname)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">## Reading layer `nc' from data source `/home/travis/R/Library/sf/shape/nc.shp' using driver `ESRI Shapefile'</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">## Simple feature collection with 100 features and 14 fields</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">## geometry type:  MULTIPOLYGON</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">## dimension:      XY</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">## epsg (SRID):    4267</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">## proj4string:    +proj=longlat +datum=NAD27 +no_defs</a></code></pre></div>
<p>Typical users will use a file name with path for <code>fname</code>, or first set R’s working directory with <code><a href="https://www.rdocumentation.org/packages/base/topics/getwd">setwd()</a></code> and use file name without path.</p>
<p>We see here that a single argument is used to find both the datasource and the layer. This works when the datasource contains a single layer. In case the number of layers is zero (e.g. a database with no tables), an error message is given. In case there are more layers than one, the first layer is returned, but a message and a warning are given:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/st_read.html">st_read</a></span>(<span class="st">"PG:dbname=postgis"</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">Multiple layers are present <span class="cf">in</span> data source PG<span class="op">:</span>dbname=postgis, reading layer <span class="st">`</span><span class="dt">meuse'.</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="dt">Use </span><span class="st">`</span>st_layers<span class="st">' to list all layer names and their type in a data source.</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="st">Set the `layer'</span> argument <span class="cf">in</span> <span class="st">`</span><span class="dt">st_read' to read a particular layer.</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="dt">Reading layer </span><span class="st">`</span>meuse<span class="st">' from data source `PG:dbname=postgis'</span> using driver <span class="st">`</span><span class="dt">PostgreSQL'</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="dt">Simple feature collection with 155 features and 12 fields</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="dt">geometry type:  POINT</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="dt">dimension:      XY</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="dt">bbox:           xmin: 178605 ymin: 329714 xmax: 181390 ymax: 333611</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="dt">epsg (SRID):    28992</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="dt">proj4string:    +proj=sterea +lat_0=52.15616055555555 ...</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="dt">Warning message:</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="dt">In eval(substitute(expr), envir, enclos) :</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="dt">  automatically selected the first layer in a data source containing more than one.</span></a></code></pre></div>
<p>The message points to the <code>st_layers</code> command, which lists the driver and layers in a datasource, e.g.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="op">&gt;</span><span class="st"> </span><span class="kw"><a href="../reference/st_layers.html">st_layers</a></span>(<span class="st">"PG:dbname=postgis"</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">Driver<span class="op">:</span><span class="st"> </span>PostgreSQL </a>
<a class="sourceLine" id="cb3-3" data-line-number="3">Available layers<span class="op">:</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span>layer_name geometry_type features fields</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="dv">1</span>      meuse         Point      <span class="dv">155</span>     <span class="dv">12</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="dv">2</span>   meuse_sf         Point      <span class="dv">155</span>     <span class="dv">12</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="dv">3</span>       sids Multi Polygon      <span class="dv">100</span>     <span class="dv">14</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="dv">4</span>  meuse_tbl         Point      <span class="dv">155</span>     <span class="dv">13</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="dv">5</span> meuse_tbl2         Point      <span class="dv">155</span>     <span class="dv">13</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="op">&gt;</span><span class="st"> </span></a></code></pre></div>
<p>A particular layer can now be read by e.g.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/st_read.html">st_read</a></span>(<span class="st">"PG:dbname=postgis"</span>, <span class="st">"sids"</span>)</a></code></pre></div>
<p><code>st_layers</code> has the option to count the number of features in case these are missing: some datasources (e.g. OSM xml files) do not report the number of features, but need to be completely read for this. GDAL allows for more than one geometry column for a feature layer; these are reported by <code>st_layers</code>.</p>
<p>In case a layer contains only geometries but no attributes (fields), <code>st_read</code> still returns an <code>sf</code> object, with a geometry column only.</p>
<p>We see that GDAL automatically detects the driver (file format) of the datasource, by trying them all in turn.</p>
<p><code>st_read</code> follows the conventions of base R, similar to how it reads tabular data into <code>data.frame</code>s. This means that character data are read, by default as <code>factor</code>s. For those who insist on retrieving character data as character vectors, the argument <code>stringsAsFactors</code> can be set to <code>FALSE</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/st_read.html">st_read</a></span>(fname, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Alternatively, a user can set the global option <code>stringsAsFactors</code>, and this will have the same effect:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="../reference/st_read.html">st_read</a></span>(fname)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">## Reading layer `nc' from data source `/home/travis/R/Library/sf/shape/nc.shp' using driver `ESRI Shapefile'</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">## Simple feature collection with 100 features and 14 fields</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">## geometry type:  MULTIPOLYGON</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">## dimension:      XY</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">## bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">## epsg (SRID):    4267</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">## proj4string:    +proj=longlat +datum=NAD27 +no_defs</a></code></pre></div>
</div>
<div id="using-st_write" class="section level3">
<h3 class="hasAnchor">
<a href="#using-st_write" class="anchor"></a>Using st_write</h3>
<p>To write a simple features object to a file, we need at least two arguments, the object and a filename:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/st_write.html">st_write</a></span>(nc, <span class="st">"nc1.shp"</span>)</a></code></pre></div>
<p>The file name is taken as the data source name. The default for the layer name is the basename (filename without path) of the the data source name. For this, <code>st_write</code> needs to guess the driver. The above command is, for instance, equivalent to:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/st_write.html">st_write</a></span>(nc, <span class="dt">dsn =</span> <span class="st">"nc1.shp"</span>, <span class="dt">layer =</span> <span class="st">"nc.shp"</span>, <span class="dt">driver =</span> <span class="st">"ESRI Shapefile"</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">## Writing layer `nc' to data source `nc1.shp' using driver `ESRI Shapefile'</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">## features:       100</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">## fields:         14</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">## geometry type:  Multi Polygon</a></code></pre></div>
<p>How the guessing of drivers works is explained in the next section.</p>
</div>
<div id="guessing-a-driver-for-output" class="section level3">
<h3 class="hasAnchor">
<a href="#guessing-a-driver-for-output" class="anchor"></a>Guessing a driver for output</h3>
<p>The output driver is guessed from the datasource name, either from its extension (<code>.shp</code>: <code>ESRI Shapefile</code>), or its prefix (<code>PG:</code>: <code>PostgreSQL</code>). The list of extensions with corresponding driver (short driver name) is:</p>
<table class="table">
<thead><tr class="header">
<th>extension</th>
<th>driver short name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>bna</code></td>
<td><code>BNA</code></td>
</tr>
<tr class="even">
<td><code>csv</code></td>
<td><code>CSV</code></td>
</tr>
<tr class="odd">
<td><code>e00</code></td>
<td><code>AVCE00</code></td>
</tr>
<tr class="even">
<td><code>gdb</code></td>
<td><code>FileGDB</code></td>
</tr>
<tr class="odd">
<td><code>geojson</code></td>
<td><code>GeoJSON</code></td>
</tr>
<tr class="even">
<td><code>gml</code></td>
<td><code>GML</code></td>
</tr>
<tr class="odd">
<td><code>gmt</code></td>
<td><code>GMT</code></td>
</tr>
<tr class="even">
<td><code>gpkg</code></td>
<td><code>GPKG</code></td>
</tr>
<tr class="odd">
<td><code>gps</code></td>
<td><code>GPSBabel</code></td>
</tr>
<tr class="even">
<td><code>gtm</code></td>
<td><code>GPSTrackMaker</code></td>
</tr>
<tr class="odd">
<td><code>gxt</code></td>
<td><code>Geoconcept</code></td>
</tr>
<tr class="even">
<td><code>jml</code></td>
<td><code>JML</code></td>
</tr>
<tr class="odd">
<td><code>map</code></td>
<td><code>WAsP</code></td>
</tr>
<tr class="even">
<td><code>mdb</code></td>
<td><code>Geomedia</code></td>
</tr>
<tr class="odd">
<td><code>nc</code></td>
<td><code>netCDF</code></td>
</tr>
<tr class="even">
<td><code>ods</code></td>
<td><code>ODS</code></td>
</tr>
<tr class="odd">
<td><code>osm</code></td>
<td><code>OSM</code></td>
</tr>
<tr class="even">
<td><code>pbf</code></td>
<td><code>OSM</code></td>
</tr>
<tr class="odd">
<td><code>shp</code></td>
<td><code>ESRI Shapefile</code></td>
</tr>
<tr class="even">
<td><code>sqlite</code></td>
<td><code>SQLite</code></td>
</tr>
<tr class="odd">
<td><code>vdv</code></td>
<td><code>VDV</code></td>
</tr>
<tr class="even">
<td><code>xls</code></td>
<td><code>xls</code></td>
</tr>
<tr class="odd">
<td><code>xlsx</code></td>
<td><code>XLSX</code></td>
</tr>
</tbody>
</table>
<p>The list with prefixes is:</p>
<table class="table">
<thead><tr class="header">
<th>prefix</th>
<th>driver short name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>couchdb:</code></td>
<td><code>CouchDB</code></td>
</tr>
<tr class="even">
<td><code>DB2ODBC:</code></td>
<td><code>DB2ODBC</code></td>
</tr>
<tr class="odd">
<td><code>DODS:</code></td>
<td><code>DODS</code></td>
</tr>
<tr class="even">
<td><code>GFT:</code></td>
<td><code>GFT</code></td>
</tr>
<tr class="odd">
<td><code>MSSQL:</code></td>
<td><code>MSSQLSpatial</code></td>
</tr>
<tr class="even">
<td><code>MySQL:</code></td>
<td><code>MySQL</code></td>
</tr>
<tr class="odd">
<td><code>OCI:</code></td>
<td><code>OCI</code></td>
</tr>
<tr class="even">
<td><code>ODBC:</code></td>
<td><code>ODBC</code></td>
</tr>
<tr class="odd">
<td><code>PG:</code></td>
<td><code>PostgreSQL</code></td>
</tr>
<tr class="even">
<td><code>SDE:</code></td>
<td><code>SDE</code></td>
</tr>
</tbody>
</table>
</div>
<div id="dataset-and-layer-reading-or-creation-options" class="section level3">
<h3 class="hasAnchor">
<a href="#dataset-and-layer-reading-or-creation-options" class="anchor"></a>Dataset and layer reading or creation options</h3>
<p>Various GDAL drivers have options that influences the reading or writing process, for example what the driver should do when a table already exists in a database: append records to the table or overwrite it:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/st_write.html">st_write</a></span>(<span class="kw"><a href="../reference/st_as_sf.html">st_as_sf</a></span>(meuse), <span class="st">"PG:dbname=postgis"</span>, <span class="st">"meuse"</span>, </a>
<a class="sourceLine" id="cb9-2" data-line-number="2">    <span class="dt">layer_options =</span> <span class="st">"OVERWRITE=true"</span>)</a></code></pre></div>
<p>In case the table exists and the option is not specified, the driver will give an error. Driver-specific options are documented in the driver manual of <a href="http://www.gdal.org/ogr_formats.html">gdal</a>. Multiple options can be given by multiple strings in <code>options</code>.</p>
<p>For <code>st_read</code>, there is only <code>options</code>; for <code>st_write</code>, one needs to distinguish between <code>dataset_options</code> and <code>layer_options</code>, the first related to opening a dataset, the second to creating layers in the dataset.</p>
</div>
</div>
<div id="reading-and-writing-directly-to-and-from-spatial-databases" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-and-writing-directly-to-and-from-spatial-databases" class="anchor"></a>Reading and writing directly to and from spatial databases</h2>
<p>Package <code>sf</code> supports reading and writing from and to spatial databases using the <code>DBI</code> interface. So far, testing has mainly be done with <code>PostGIS</code>, other databases might work but may also need more work. An example of reading is:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(RPostgreSQL) </a>
<a class="sourceLine" id="cb10-2" data-line-number="2">conn =<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/RPostgreSQL/topics/PostgreSQL">PostgreSQL</a></span>(), <span class="dt">dbname =</span> <span class="st">"postgis"</span>) </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">meuse =<span class="st"> </span><span class="kw"><a href="../reference/st_read.html">st_read</a></span>(conn, <span class="st">"meuse"</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">meuse_<span class="dv">1</span>_<span class="dv">3</span> =<span class="st"> </span><span class="kw"><a href="../reference/st_read.html">st_read</a></span>(conn, <span class="dt">query =</span> <span class="st">"select * from meuse limit 3;"</span>) </a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">dbDisconnect</span>(conn) </a></code></pre></div>
<p>We see here that in the second example a query is given. This query may contain spatial predicates, which could be a way to work through massive spatial datasets in R without having to read them completely in memory.</p>
<p>Similarly, tables can be written:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">conn =<span class="st"> </span><span class="kw">dbConnect</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/RPostgreSQL/topics/PostgreSQL">PostgreSQL</a></span>(), <span class="dt">dbname =</span> <span class="st">"postgis"</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="../reference/st_write.html">st_write</a></span>(conn, meuse, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">dbDisconnect</span>(conn)</a></code></pre></div>
<p>Here, the default table (layer) name is taken from the object name (<code>meuse</code>). Argument <code>drop</code> informs to drop (remove) the table before writing; logical argument <code>binary</code> determines whether to use well-known binary or well-known text when writing the geometry (where well-known binary is faster and lossless).</p>
</div>
<div id="conversion-to-other-formats-wkt-wkb-sp" class="section level2">
<h2 class="hasAnchor">
<a href="#conversion-to-other-formats-wkt-wkb-sp" class="anchor"></a>Conversion to other formats: WKT, WKB, sp</h2>
<div id="conversion-to-and-from-well-known-text" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-to-and-from-well-known-text" class="anchor"></a>Conversion to and from well-known text</h3>
<p>The usual form in which we see simple features printed is well-known text:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">## POINT (0 1)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="../reference/st.html">st_linestring</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">9</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</a></code></pre></div>
<p>We can create these well-known text strings explicitly using <code>st_as_text</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">x =<span class="st"> </span><span class="kw"><a href="../reference/st.html">st_linestring</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">9</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">str =<span class="st"> </span><span class="kw"><a href="../reference/st_as_text.html">st_as_text</a></span>(x)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">x</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</a></code></pre></div>
<p>We can convert back from WKT by using <code>st_as_sfc</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../reference/st_as_sfc.html">st_as_sfc</a></span>(str)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">## Geometry set for 1 feature </a>
<a class="sourceLine" id="cb14-3" data-line-number="3">## geometry type:  LINESTRING</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">## dimension:      XY</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">## bbox:           xmin: 0 ymin: 1 xmax: 8 ymax: 9</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">## epsg (SRID):    NA</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">## proj4string:    NA</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">## LINESTRING (0 1, 2 3, 4 5, 6 7, 8 9)</a></code></pre></div>
</div>
<div id="conversion-to-and-from-well-known-binary" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-to-and-from-well-known-binary" class="anchor"></a>Conversion to and from well-known binary</h3>
<p>Well-known binary is created from simple features by <code>st_as_binary</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">x =<span class="st"> </span><span class="kw"><a href="../reference/st.html">st_linestring</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">9</span>,<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">(<span class="dt">x =</span> <span class="kw"><a href="../reference/st_as_binary.html">st_as_binary</a></span>(x))</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">##  [1] 01 02 00 00 00 05 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">## [24] f0 3f 00 00 00 00 00 00 00 40 00 00 00 00 00 00 08 40 00 00 00 00 00</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">## [47] 00 10 40 00 00 00 00 00 00 14 40 00 00 00 00 00 00 18 40 00 00 00 00</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">## [70] 00 00 1c 40 00 00 00 00 00 00 20 40 00 00 00 00 00 00 22 40</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(x)</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">## [1] "raw"</a></code></pre></div>
<p>The object returned by <code>st_as_binary</code> is of class <code>WKB</code> and is either a list with raw vectors, or a single raw vector. These can be converted into a hexadecimal character vector using <code>rawToHex</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/rawToHex.html">rawToHex</a></span>(x)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">## [1] "0102000000050000000000000000000000000000000000f03f000000000000004000000000000008400000000000001040000000000000144000000000000018400000000000001c4000000000000020400000000000002240"</a></code></pre></div>
<p>Converting back to <code>sf</code> uses <code>st_as_sfc</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">x =<span class="st"> </span><span class="kw"><a href="../reference/st_as_binary.html">st_as_binary</a></span>(<span class="kw"><a href="../reference/sfc.html">st_sfc</a></span>(<span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>), <span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>)))</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="../reference/st_as_sfc.html">st_as_sfc</a></span>(x)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">## Geometry set for 2 features </a>
<a class="sourceLine" id="cb17-4" data-line-number="4">## geometry type:  POINT</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">## dimension:      XY</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">## bbox:           xmin: 0 ymin: 1 xmax: 5 ymax: 6</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">## epsg (SRID):    NA</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">## proj4string:    NA</a>
<a class="sourceLine" id="cb17-9" data-line-number="9">## POINT (0 1)</a>
<a class="sourceLine" id="cb17-10" data-line-number="10">## POINT (5 6)</a></code></pre></div>
</div>
<div id="conversion-to-and-from-sp" class="section level3">
<h3 class="hasAnchor">
<a href="#conversion-to-and-from-sp" class="anchor"></a>Conversion to and from sp</h3>
<p>Spatial objects as maintained by package <code>sp</code> can be converted into simple feature objects or geometries by <code>st_as_sf</code> and <code>st_as_sfc</code>, respectively:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/methods">methods</a></span>(st_as_sf)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">## [1] st_as_sf.data.frame* st_as_sf.lpp*        st_as_sf.map*       </a>
<a class="sourceLine" id="cb18-3" data-line-number="3">## [4] st_as_sf.ppp*        st_as_sf.psp*        st_as_sf.sf*        </a>
<a class="sourceLine" id="cb18-4" data-line-number="4">## [7] st_as_sf.Spatial*   </a>
<a class="sourceLine" id="cb18-5" data-line-number="5">## see '?methods' for accessing help and source code</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/methods">methods</a></span>(st_as_sfc)</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">##  [1] st_as_sfc.bbox*               st_as_sfc.blob*              </a>
<a class="sourceLine" id="cb18-8" data-line-number="8">##  [3] st_as_sfc.character*          st_as_sfc.dimensions*        </a>
<a class="sourceLine" id="cb18-9" data-line-number="9">##  [5] st_as_sfc.factor*             st_as_sfc.list*              </a>
<a class="sourceLine" id="cb18-10" data-line-number="10">##  [7] st_as_sfc.map*                st_as_sfc.raw*               </a>
<a class="sourceLine" id="cb18-11" data-line-number="11">##  [9] st_as_sfc.SpatialLines*       st_as_sfc.SpatialMultiPoints*</a>
<a class="sourceLine" id="cb18-12" data-line-number="12">## [11] st_as_sfc.SpatialPixels*      st_as_sfc.SpatialPoints*     </a>
<a class="sourceLine" id="cb18-13" data-line-number="13">## [13] st_as_sfc.SpatialPolygons*    st_as_sfc.WKB*               </a>
<a class="sourceLine" id="cb18-14" data-line-number="14">## see '?methods' for accessing help and source code</a></code></pre></div>
<p>An example would be:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sp)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(meuse)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/sp/topics/coordinates">coordinates</a></span>(meuse) =<span class="st"> </span><span class="er">~</span>x<span class="op">+</span>y</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">m.sf =<span class="st"> </span><span class="kw"><a href="../reference/st_as_sf.html">st_as_sf</a></span>(meuse)</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">opar =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw"><a href="../reference/plot.html">plot</a></span>(m.sf)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">## Warning: plotting the first 10 out of 12 attributes; use max.plot = 12 to</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">## plot all</a></code></pre></div>
<p><img src="sf2_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>Conversion of simple feature objects of class <code>sf</code> or <code>sfc</code> into corresponding <code>Spatial*</code> objects is done using the <code>as</code> method, coercing to <code>Spatial</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">x =<span class="st"> </span><span class="kw"><a href="../reference/sfc.html">st_sfc</a></span>(<span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">5</span>,<span class="dv">5</span>)), <span class="kw"><a href="../reference/st.html">st_point</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">6</span>,<span class="dv">9</span>)), <span class="dt">crs =</span> <span class="dv">4326</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw"><a href="../reference/coerce-methods.html">as</a></span>(x, <span class="st">"Spatial"</span>)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">## SpatialPoints:</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">##      coords.x1 coords.x2</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">## [1,]         5         5</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">## [2,]         6         9</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">## Coordinate Reference System (CRS) arguments: +proj=longlat</a>
<a class="sourceLine" id="cb20-8" data-line-number="8">## +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#reading-and-writing-through-gdal">Reading and writing through GDAL</a></li>
      <li><a href="#reading-and-writing-directly-to-and-from-spatial-databases">Reading and writing directly to and from spatial databases</a></li>
      <li><a href="#conversion-to-other-formats-wkt-wkb-sp">Conversion to other formats: WKT, WKB, sp</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
